# BTS-0000033: ì¬ì‹œë„ ë²„íŠ¼ í´ë¦­ ì‹œ type/status ì—…ë°ì´íŠ¸ ì•ˆ ë¨

**ë°œìƒì¼:** 2025-12-03

**ìƒíƒœ:** âœ… **í•´ê²°ë¨**

**ì‹¬ê°ë„:** ğŸ”´ **CRITICAL** - ì¬ì‹œë„ ê¸°ëŠ¥ ì™„ì „ ì‘ë™ ë¶ˆê°€

**ì¦ìƒ:**
- ì¬ì‹œë„ ë²„íŠ¼ í´ë¦­ ì‹œ ë¡œê·¸ì—ë§Œ "ì¬ì‹œë„: youtube(failed) â†’ youtube ì§ì ‘ ì‹¤í–‰" í‘œì‹œ
- task_queueì˜ typeê³¼ statusê°€ ì‹¤ì œë¡œëŠ” ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠìŒ
- ìƒíƒœê°€ ê³„ì† failedë¡œ ë‚¨ì•„ìˆì–´ ì¬ì‹œë„ê°€ ì‘ë™í•˜ì§€ ì•ŠìŒ

**ê·¼ë³¸ ì›ì¸:**
- retry APIê°€ `task_queue` ì—…ë°ì´íŠ¸ ì‹œ `status = 'processing'`ìœ¼ë¡œ ì„¤ì •
- WorkerëŠ” status='waiting'ì¸ ì‘ì—…ë§Œ ì²˜ë¦¬í•˜ë„ë¡ ì„¤ê³„ë¨
- Workerê°€ ë½ íšë“ ì‹œë„ ì‹œ status='processing'ì´ë¯€ë¡œ ê±°ë¶€
- ì—ëŸ¬: "âŒ ë½ íšë“ ì‹¤íŒ¨: í˜„ì¬ status=processing (ì´ë¯¸ ì²˜ë¦¬ ì¤‘ì´ê±°ë‚˜ ì™„ë£Œë¨)"
- ê²°ê³¼: ë¡œê·¸ë§Œ ì°íˆê³  ì‹¤ì œ ì‹¤í–‰ì€ ì•ˆ ë¨

**ìˆ˜ì • ë°©ë²•:**
`src/app/api/automation/retry/route.ts:326` ìˆ˜ì •

```typescript
// âŒ ì˜ëª»ëœ ì½”ë“œ (Workerê°€ ë½ì„ íšë“í•  ìˆ˜ ì—†ìŒ)
UPDATE task_queue
SET type = ?, status = 'processing', error = NULL
WHERE task_id = ?

// âœ… ìˆ˜ì •ëœ ì½”ë“œ (Workerê°€ ìì—°ìŠ¤ëŸ½ê²Œ ì²˜ë¦¬)
UPDATE task_queue
SET type = ?, status = 'waiting', error = NULL
WHERE task_id = ?
```

**ìˆ˜ì •ëœ íŒŒì¼:**
1. `src/app/api/automation/retry/route.ts:323-328` - status 'processing' â†’ 'waiting'
2. `src/app/api/automation/retry/route.ts:348-349` - ë¡œê·¸ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸

**ì¬ë°œ ë°©ì§€:**
- task_queue ì—…ë°ì´íŠ¸ ì‹œ `status = 'waiting'` ì‚¬ìš© (Workerê°€ ì²˜ë¦¬)
- `status = 'processing'`ì€ Workerê°€ ì§ì ‘ ì„¤ì •í•˜ëŠ” ê²ƒì´ë¯€ë¡œ ìˆ˜ë™ ì„¤ì • ê¸ˆì§€
- forceType ë°©ì‹(ì •ìƒ ì‘ë™)ê³¼ ë™ì¼í•œ íŒ¨í„´ ì‚¬ìš©

**ìƒì„¸ ë¬¸ì„œ:** `BTS-0000033.md`

---
