# BTS-0000036: 이미지 크롤링 사용 시 dalle3 로그가 출력되어 헷갈림

**발생일:** 2025-12-03

**상태:** ✅ 해결됨

**심각도:** 🟡 **MINOR** - 로그 혼란

---

## 증상

- 영상 생성 시 **이미지 크롤링 모드**로 실행했는데
- 로그에 "🎨 이미지 생성 모델: dalle3 (provider: openai)" 출력됨
- 실제로는 Google 이미지 검색으로 크롤링하는데 dalle3 로그가 나와서 **매우 헷갈림**

**사용자 피드백:**
> "영상생성중에 나오는데 나는 이미지 크롤링으로 한건데 시벌아 헷갈리게 로깅하지말라니까"

---

## 근본 원인

### 로그 출력이 imageSource를 무시함

**문제 파일:** `src/app/api/generate-video-upload/route.ts:613`

**문제 코드:**
```javascript
const imageProvider = imageProviderMap[config.imageModel] || 'openai';
const imageProviderArg = ['--image-provider', imageProvider];
console.log(`🎨 이미지 생성 모델: ${config.imageModel} (provider: ${imageProvider})`);
```

**문제점:**
1. `config.imageSource`가 'crawl', 'ai', 'none' 중 무엇인지 체크하지 않음
2. **무조건** dalle3 로그를 출력함
3. 크롤링 모드에서도 imageProvider 변수를 설정하고 로그에 출력함

**imageSource 옵션:**
- `'ai'` - AI 이미지 생성 (dalle3, imagen3 등)
- `'crawl'` - Google 이미지 검색 크롤링
- `'none'` - 이미지 직접 업로드 (AI 생성 안 함)

---

## 해결 방법

### imageSource별로 정확한 로그 출력

**수정 파일:** `src/app/api/generate-video-upload/route.ts:614-623`

**수정 코드:**
```javascript
// 이미지 소스별 로그 출력 (헷갈리지 않게)
if (config.imageSource === 'crawl') {
  console.log(`🔍 이미지 소스: 크롤링 (Google 이미지 검색)`);
} else if (config.imageSource === 'ai') {
  console.log(`🎨 이미지 소스: AI 생성 (모델: ${config.imageModel}, provider: ${imageProvider})`);
} else if (config.imageSource === 'none') {
  console.log(`📁 이미지 소스: 직접 업로드 (AI 생성 안 함)`);
} else {
  console.log(`🎨 이미지 소스: ${config.imageSource || '기본값'}`);
}
```

**로그 예시:**
- 크롤링 사용 → "🔍 이미지 소스: 크롤링 (Google 이미지 검색)"
- AI 생성 사용 → "🎨 이미지 소스: AI 생성 (모델: dalle3, provider: openai)"
- 직접 업로드 → "📁 이미지 소스: 직접 업로드 (AI 생성 안 함)"

---

## 재발 방지

### 로그 작성 규칙

1. ✅ **조건부 로그 출력** - 상태/모드에 따라 다른 로그 출력
2. ✅ **명확한 아이콘 사용**
   - 🔍 = 크롤링
   - 🎨 = AI 생성
   - 📁 = 직접 업로드
3. ✅ **사용자 선택을 정확히 반영** - config.imageSource 값을 체크

---

## 영향 범위

**수정된 파일:**
- `src/app/api/generate-video-upload/route.ts:614-623` - 로그 출력 로직 개선

**영향 받는 기능:**
- 영상 생성 API (모든 포맷: longform, shortform, product, sora2)
- 이미지 소스 선택 (ai, crawl, none)

**테스트 방법:**
1. 크롤링 모드로 영상 생성 실행
2. 로그에 "🔍 이미지 소스: 크롤링 (Google 이미지 검색)" 출력 확인
3. AI 생성 모드로 실행 → "🎨 이미지 소스: AI 생성..." 확인

---

## 구현 완료

- ✅ imageSource별 정확한 로그 출력 구현
- ✅ 크롤링/AI/직접업로드 구분 명확히 표시
- ✅ 헷갈리는 로그 제거
