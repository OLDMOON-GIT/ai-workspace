# BTS-0000017: video ìƒì„± ë¹„ë™ê¸° ì‹¤í–‰ìœ¼ë¡œ youtube ë‹¨ê³„ ì¡°ê¸° ì§„ì…

**ë°œìƒì¼:** 2025-12-02

**ìƒíƒœ:** âœ… **í•´ê²°ë¨**

**ì‹¬ê°ë„:** ğŸ”´ **CRITICAL** - ì˜ìƒ ìƒì„±ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ëŠ”ë° youtube ì—…ë¡œë“œë¡œ ë„˜ì–´ê°€ì„œ ì‹¤íŒ¨

**ì¦ìƒ:**
```
Python script exited with code 2
python: can't open file 'C:\\Users\\oldmoon\\workspace\\trend-video-backend\\src\\youtube\\upload.py': [Errno 2] No such file or directory
```
- video ìƒì„±ì´ ì™„ë£Œë˜ê¸° ì „ì— youtube ë‹¨ê³„ë¡œ ì „í™˜
- ì˜ìƒ íŒŒì¼ì´ ì•„ì§ ì—†ì–´ì„œ youtube ì—…ë¡œë“œ ì‹¤íŒ¨

**ê·¼ë³¸ ì›ì¸:**
`/api/generate-video-upload/route.ts`ê°€ **ë¹„ë™ê¸°ë¡œ ì˜ìƒ ìƒì„±ì„ ì‹œì‘í•˜ê³  ë°”ë¡œ ë¦¬í„´**

**ë¬¸ì œ ì½”ë“œ:**

1. **route.ts:345-368** (ë¹„ë™ê¸° ì‹¤í–‰):
```javascript
// ë¹„ë™ê¸°ë¡œ ì˜ìƒ ìƒì„± ì‹œì‘
generateVideoFromUpload(taskId, userId, cost, {
  // ... ì„¤ì •ë“¤
});

return NextResponse.json({
  success: true,
  taskId,
  message: 'ì˜ìƒ ìƒì„±ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.'  // âš ï¸ "ì‹œì‘"ë§Œ!
});
```

2. **unified-worker.js:519-538** (ì˜ëª»ëœ ì™„ë£Œ íŒë‹¨):
```javascript
const response = await fetch(apiUrl, {
  method: 'POST',
  body: JSON.stringify({
    scriptId: taskId,
    type: promptFormat
  })
});

const result = await response.json();
console.log(`${emoji} [${type}] âœ… API call completed`);
await this.appendLog(taskId, type, `âœ… ì˜ìƒ ìƒì„± ì™„ë£Œ`);  // âš ï¸ ì‹¤ì œë¡œëŠ” ì‹œì‘ë§Œ í–ˆëŠ”ë°!
```

**ì‹¤í–‰ íë¦„:**
```
1. unified-worker: video API í˜¸ì¶œ
2. API: generateVideoFromUpload() ë¹„ë™ê¸° ì‹¤í–‰ (await ì—†ìŒ)
3. API: ë°”ë¡œ ë¦¬í„´ { message: 'ì˜ìƒ ìƒì„±ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.' }
4. unified-worker: "ì˜ìƒ ìƒì„± ì™„ë£Œ" ë¡œê·¸ ì¶œë ¥ (ì‹¤ì œë¡œëŠ” ì‹œì‘ë§Œ í•¨!)
5. unified-worker: youtube ë‹¨ê³„ë¡œ ì „í™˜ (triggerNextStage)
6. youtube-worker: upload.py ì‹¤í–‰ â†’ ì˜ìƒ íŒŒì¼ ì—†ìŒ â†’ ì‹¤íŒ¨!
```

**ìˆ˜ì • ë‚´ì—­:**

1. **generate-video-upload/route.ts:345** - await ì¶”ê°€:
```javascript
// âœ… BTS-0000017: ë™ê¸°ë¡œ ì˜ìƒ ìƒì„± ì™„ë£Œê¹Œì§€ ëŒ€ê¸° (await ì¶”ê°€)
await generateVideoFromUpload(taskId, userId, cost, {
  // ... ì„¤ì •ë“¤
});

return NextResponse.json({
  success: true,
  taskId,
  message: 'ì˜ìƒ ìƒì„±ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.'  // âœ… "ì™„ë£Œ"ë¡œ ìˆ˜ì •
});
```

2. **videos/generate/route.ts:150-155** - ë©”ì‹œì§€ ìˆ˜ì •:
```javascript
const result = await videoResponse.json();
console.log('âœ… [VIDEO-GEN] Video generation completed:', result);

return NextResponse.json({
  success: true,
  taskId: result.taskId,
  message: 'Video generation completed'  // âœ… "completed"ë¡œ ìˆ˜ì •
});
```

3. **unified-worker.js:537** - ì£¼ì„ ì¶”ê°€:
```javascript
const result = await response.json();
// âœ… BTS-0000017: APIê°€ ì˜ìƒ ìƒì„± ì™„ë£Œê¹Œì§€ ë™ê¸°ë¡œ ëŒ€ê¸°í•˜ë¯€ë¡œ ì´ ì‹œì ì—ì„œ ì‹¤ì œë¡œ ì™„ë£Œë¨
console.log(`${emoji} [${type}] âœ… API call completed`);
await this.appendLog(taskId, type, `âœ… ì˜ìƒ ìƒì„± ì™„ë£Œ`);
```

**ê²°ê³¼:**
- APIê°€ Python í”„ë¡œì„¸ìŠ¤ ì™„ë£Œê¹Œì§€ ë™ê¸°ë¡œ ëŒ€ê¸°
- unified-workerê°€ youtube ë‹¨ê³„ë¡œ ì „í™˜í•˜ê¸° ì „ì— ì˜ìƒ íŒŒì¼ì´ ìƒì„±ë¨
- youtube ì—…ë¡œë“œ ì •ìƒ ì‘ë™

---
