# BTS-0000032: Next.js 빌드 캐시 손상으로 서버 시작 실패

**발생일:** 2025-12-03

**상태:** ✅ **해결됨**

**심각도:** 🔴 **CRITICAL** - 서버가 완전히 동작하지 않음

**증상:**
- az.bat 실행 후 Next.js 서버 시작 시 MODULE_NOT_FOUND 에러 발생
- `Error: Cannot find module '../chunks/ssr/[turbopack]_runtime.js'`
- `Error: ENOENT: no such file or directory, open '.next/dev/server/app/api/.../app-paths-manifest.json'`
- 여러 API route가 컴파일 실패
- 반복적으로 발생 ("아까도 그냥 깨졌는데?")

**근본 원인:**
- az.bat 실행 중 또는 직후 .next 폴더 캐시가 손상됨
- Next.js Turbopack 빌드 캐시의 manifest 파일들이 불완전한 상태로 남음
- 포트 강제 종료 후 즉시 재시작하면서 빌드 상태가 중간에 끊김 가능성

**수정 방법:**
`.next` 폴더 완전 삭제 후 Next.js가 자동으로 재빌드하도록 함

```bash
cd trend-video-frontend
powershell -Command "if (Test-Path .next) { Remove-Item -Recurse -Force .next }"
# npm run dev가 자동으로 .next 재생성
```

**재발 방지:**
- az.bat에서 포트 종료 후 충분한 대기 시간 확보 필요 (현재 2초)
- 서버 재시작 전 .next 폴더 정리 옵션 고려
- 또는 graceful shutdown 방식으로 변경 필요

**관련 파일:**
- `az.bat:129-137` - 서버 재시작 로직
- `.next/` - Next.js 빌드 캐시 디렉토리

**User Quote:** "아까도 그냥 깨졌는데?" (반복 발생 확인)

---
