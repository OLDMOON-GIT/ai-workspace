# BTS-0000013: open-folder API에 SQLite 레거시 코드 미전환

**발생일:** 2025-12-02

**상태:** ✅ 해결됨

**증상:**
```
Module not found: Can't resolve 'better-sqlite3'
at ./src/app/api/open-folder/route.ts:42:26
```

**원인:**
- 시스템은 MySQL로 마이그레이션 완료
- `src/app/api/open-folder/route.ts` (lines 42-56)에만 SQLite 코드 남아있음
- `better-sqlite3` 패키지는 이미 제거됨 (BTS-0000003)

**문제 코드:**
```typescript
// ❌ SQLite 레거시 코드
const Database = require('better-sqlite3');
const dbPath = path.join(process.cwd(), 'data', 'database.sqlite');
const db = new Database(dbPath, { readonly: true });
const job = await db.prepare(`
  SELECT content_id FROM content WHERE source_content_id = ?
`).get(cleanProjectId) as any;
db.close();
```

**해결 방법:**

1. **MySQL import 추가:**
```typescript
import { getOne } from '@/lib/mysql';
```

2. **쿼리 변환:**
```typescript
// ✅ MySQL 방식
const content = await getOne(`
  SELECT content_id FROM content WHERE source_content_id = ? ORDER BY created_at DESC LIMIT 1
`, [cleanProjectId]) as any;
if (content && content.content_id) {
  actualFolderId = content.content_id;
}
```

**수정 파일:**
- `src/app/api/open-folder/route.ts` (lines 1-6, 40-53)

**재발 방지:**
- 마이그레이션 완료 후 `better-sqlite3` 전체 검색 필수
- API 라우트는 테스트 커버리지 확대 필요

---
