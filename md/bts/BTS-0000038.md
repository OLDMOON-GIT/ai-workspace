# BTS-0000038: AI 생성 대본 narration 품질 저하 (오타, 의미 불명 문장)

**발생일:** 2025-12-03

**상태:** ✅ 해결됨

**심각도:** 🔴 **CRITICAL** - 대본 품질 치명적 저하

---

## 증상

AI가 생성한 상품 대본의 narration에 **오타와 의미 불명 문장**이 다수 발견됨.

**사용자 피드백:**
> "대본이 너무 구리게 나오는데? 최초맨트도 좆같구"

**실제 문제 사례:**

### Scene 1 (문제 제시):
```
"매일 엄청난 한두 얼음 뒷매에 여러가지 건강을 생겨야 하지만, 어린이와 함께 맛있게 즐길 신선한 도움이 필요하시지 않았나요?"
```
❌ **완전히 의미 불명** - 주어, 동사, 목적어가 문법적으로 연결되지 않음

### Scene 2 (해결책):
```
"더존건강 NFC 착장 100% ABC 주스로 해결하세요. 사과, 등, 캠을 넣어 숫사로 매일 착장한..."
```
❌ **오타 다수:**
- "착장" → "착즙" (O)
- "등, 캠" → "비트, 당근" (O)
- "숫사로" → "신선하게" (O)

### Scene 3 (만족):
```
"온 가족 건강을 삶을 그대로 담은 신선한 컴갱 NFC 주스로..."
```
❌ **오타 및 어색한 표현:**
- "컴갱" → "건강" (O)
- "삶을 그대로" → "착즙을 그대로" (O)

### YouTube Description:
```
"✅ 삶을 그대로 넣은 NFC 착장 100% 원액입니다!"
"✅ 사과, 등, 캠 항산화소 농축의 핵심..."
"✅ 랍에 편의한 2.1L 대용량..."
"이에 따른 일정액의 수숲료를 제공받습다."
```
❌ **오타:**
- "착장" → "착즙"
- "등, 캠" → "비트, 당근"
- "랍에 편의한" → "편리한"
- "수숲료" → "수수료"
- "제공받습다" → "제공받습니다"

---

## 근본 원인

### 1. 프롬프트에 한글 품질 검증 규칙 부재

**문제 파일:**
- `prompts/prompt_product.txt`
- `prompts/prompt_longform.txt`
- `prompts/prompt_shortform.txt`

**문제점:**
1. **오타 방지 규칙 없음** - AI가 한글 단어를 잘못 생성해도 체크하지 않음
2. **문장 완성도 검증 없음** - 의미가 통하지 않는 문장도 그대로 출력
3. **자연스러움 검증 없음** - 어색한 번역투 표현 그대로 사용
4. **상품 정보 정확성 검증 없음** - 약어(ABC)를 풀어쓰지 않음

### 2. AI 모델의 한글 생성 품질 문제

**가능성:**
- Claude나 GPT 모델이 한글 단어를 정확히 이해하지 못함
- OCR이나 음성 인식 결과를 잘못 학습
- 영어-한글 번역 과정에서 오류 발생

---

## 해결 방법

### ✅ 프롬프트에 한글 품질 규칙 추가

**수정한 파일:**
- `prompts/prompt_product.txt:70-106` - 한글 narration 품질 규칙 추가
- `prompts/prompt_longform.txt:190-220` - 한글 narration 품질 규칙 추가
- `prompts/prompt_shortform.txt:211-241` - 한글 narration 품질 규칙 추가

**추가된 규칙:**

```markdown
🚨 **중요: 한글 narration 품질 규칙 (BTS-0000038)** 🚨

**반드시 지켜야 할 한글 작성 규칙:**

1. ✅ **한글을 유니코드로 출력 절대 금지**
   - Gemini가 한글을 유니코드(\uC548\uB155 형식)로 출력하는 문제 방지
   - ❌ 나쁜 예: "\uC548\uB155\uD558\uC138\uC694", "\uCC29\uC989"
   - ✅ 좋은 예: "안녕하세요", "착즙"
   - 모든 narration, youtube_description의 한글은 **직접 한글 문자로 출력**

2. ✅ **완전한 문장만 작성**
   - 모든 narration은 주어, 서술어가 있는 완전한 한글 문장이어야 함
   - 의미가 통하지 않는 문장 절대 금지
   - ❌ 나쁜 예: "매일 엄청난 한두 얼음 뒷매에 여러가지 건강을 생겨야"
   - ✅ 좋은 예: "매일 아침 여러 가지 과일과 채소를 챙겨 먹기 힘드시죠?"

3. ✅ **정확한 한글 단어 사용**
   - 오타나 잘못된 단어 절대 금지
   - ❌ 나쁜 예: "착장" (X) → ✅ "착즙" (O)
   - ❌ 나쁜 예: "등, 캠" (X) → ✅ "비트, 당근" (O)
   - ❌ 나쁜 예: "컴갱" (X) → ✅ "건강" (O)
   - ❌ 나쁜 예: "숲료" (X) → ✅ "수수료" (O)
   - ❌ 나쁜 예: "랍에 편의한" (X) → ✅ "편리한" (O)

4. ✅ **자연스러운 한글 표현**
   - 한국인이 실제로 사용하는 자연스러운 표현만 사용
   - 어색한 번역투 표현 금지
   - ❌ 나쁜 예: "삶을 그대로 넣은"
   - ✅ 좋은 예: "착즙을 그대로 담은"

5. ✅ **상품 정보를 정확히 반영**
   - 상품 제목에서 핵심 키워드를 정확히 추출
   - 예: "ABC주스" → "사과(Apple), 비트(Beet), 당근(Carrot) 주스"
   - 약어나 줄임말을 풀어서 설명

6. ✅ **맞춤법과 띄어쓰기 준수**
   - 한글 맞춤법에 맞게 작성
   - 적절한 띄어쓰기 사용

**검증 규칙:**
- 모든 narration을 작성 후 한 번 더 읽어보고 의미가 통하는지 확인
- 이상한 단어나 오타가 있으면 수정
- 한국인이 듣고 바로 이해할 수 있는 문장인지 확인
```

---

## 재발 방지

### 프롬프트 작성 규칙

1. ✅ **명시적 품질 기준 제시**
   - "오타 금지", "완전한 문장" 등 명확한 규칙
   - 잘못된 예시와 올바른 예시 병기

2. ✅ **검증 단계 추가**
   - AI에게 자체 검증 요청
   - "작성 후 한 번 더 읽어보고 확인"

3. ✅ **도메인 특화 규칙**
   - 상품 대본: 상품명 키워드 정확히 추출
   - 스토리 대본: 자연스러운 한국어 대화체

4. ✅ **금칙어 리스트 확장**
   - 자주 발생하는 오타 패턴 추가
   - 예: "착장" (X), "컴갱" (X), "숲료" (X)

---

## 영향 범위

**수정된 파일:**
- `prompts/prompt_product.txt:70-106` - 한글 품질 규칙 추가
- `prompts/prompt_longform.txt:190-220` - 한글 품질 규칙 추가
- `prompts/prompt_shortform.txt:211-241` - 한글 품질 규칙 추가

**영향 받는 기능:**
- 대본 생성 API (모든 포맷: longform, shortform, product, sora2)
- AI가 생성하는 모든 narration 텍스트
- YouTube 설명 텍스트

**테스트 방법:**
1. 상품 대본 생성 (특히 ABC주스 같은 약어 포함 상품)
2. narration에 오타가 없는지 확인
3. 모든 문장이 의미가 통하는지 확인
4. 한국인이 자연스럽게 이해할 수 있는지 확인

---

## 구현 완료

- ✅ 3개 프롬프트 파일에 한글 품질 규칙 추가
- ✅ 오타 방지 예시 추가 (착장→착즙, 등/캠→비트/당근 등)
- ✅ 자연스러운 한글 표현 가이드 추가
- ✅ 상품 정보 정확 반영 규칙 추가
- ✅ 검증 단계 명시

---

## 향후 개선 방안

### 1. 후처리 검증 로직 추가

**구현 위치:** `src/lib/json-utils.cjs`

```javascript
function validateNarrationQuality(narration) {
  // 오타 패턴 검사
  const typoPatterns = [
    { wrong: /착장/g, correct: '착즙' },
    { wrong: /컴갱/g, correct: '건강' },
    { wrong: /숲료/g, correct: '수수료' },
    // ... 더 많은 패턴
  ];

  let cleaned = narration;
  typoPatterns.forEach(({ wrong, correct }) => {
    cleaned = cleaned.replace(wrong, correct);
  });

  return cleaned;
}
```

### 2. AI 모델 선택 개선

- 한글 생성 품질이 더 좋은 모델로 전환 고려
- Claude Opus, GPT-4 등 premium 모델 사용

### 3. 사용자 피드백 루프

- 대본 생성 후 사용자가 품질 평가
- 낮은 평가 받은 대본 패턴 분석 및 프롬프트 개선
