# BTS-0000023: unified-worker YouTube í† í° ê²½ë¡œ ì˜¤ë¥˜

**ë°œìƒì¼:** 2025-12-03

**ìƒíƒœ:** âœ… **í•´ê²°ë¨**

**ì‹¬ê°ë„:** ðŸ”´ **CRITICAL** - YouTube ì—…ë¡œë“œ ì¸ì¦ ì‹¤íŒ¨

**ì¦ìƒ:**
```
[ERROR] YouTube í† í°ì´ ì—†ê±°ë‚˜ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤.
{"success": false, "error": "ì¸ì¦ ì‹¤íŒ¨"}
```

**ê·¼ë³¸ ì›ì¸:**
unified-worker.jsê°€ ìž˜ëª»ëœ í† í° íŒŒì¼ëª…ìœ¼ë¡œ ì°¾ê³  ìžˆìŒ

**ìž˜ëª»ëœ ì½”ë“œ:**
```javascript
const tokenPath = path.join(credentialsDir, `youtube_token_${content.user_id}.json`);
```

**ì‹¤ì œ í† í° íŒŒì¼ëª…:**
```
youtube_token_${userId}_${channelId}.json
```

**ìˆ˜ì • ë‚´ì—­:**
`src/workers/unified-worker.js:616-640` - í† í° ê²½ë¡œ ë¡œì§ ìˆ˜ì •
1. content_setting.youtube_channelì´ ìžˆìœ¼ë©´ í•´ë‹¹ ì±„ë„ í† í° ì‚¬ìš©
2. ì—†ìœ¼ë©´ user_idë¡œ ì‹œìž‘í•˜ëŠ” í† í° íŒŒì¼ ìžë™ íƒìƒ‰ (fallback)
3. í† í°ì´ ì—†ìœ¼ë©´ ëª…í™•í•œ ì—ëŸ¬ ë©”ì‹œì§€ ì¶œë ¥

**ë¡œì§:**
```javascript
// 1. youtube_channelì´ ìžˆìœ¼ë©´ í•´ë‹¹ ì±„ë„ í† í° ì‚¬ìš©
if (content.youtube_channel) {
  tokenPath = `youtube_token_${content.user_id}_${content.youtube_channel}.json`;
}

// 2. í† í° íŒŒì¼ì´ ì—†ìœ¼ë©´ user_idë¡œ ì‹œìž‘í•˜ëŠ” ì²« ë²ˆì§¸ í† í° ì‚¬ìš©
if (!tokenPath || !fs.existsSync(tokenPath)) {
  const userTokenFiles = configFiles.filter(f =>
    f.startsWith(`youtube_token_${content.user_id}_`) && f.endsWith('.json')
  );
  tokenPath = userTokenFiles[0];
}
```

**ì°¸ê³ :**
- /api/youtube/upload/route.ts:354-421 ì°¸ê³ 

---
